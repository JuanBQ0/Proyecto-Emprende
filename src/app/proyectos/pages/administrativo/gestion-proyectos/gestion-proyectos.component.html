<nav-administrativo class="flex mb-14"></nav-administrativo>

<div class="min-h-screen bg-green-200 p-4 sm:p-6 md:p-12">
  <!----------------------------------------------------------   Buscador -------------------------------------------------------- -->
  <div class="mb-6 flex items-center space-x-3 ">
    <input
      type="text "
      [(ngModel)]="busquedaIdentificacion"
      placeholder="Buscar por identificaci√≥n..."
      class="flex-1 border border-green-400 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-green-600 bg-white"
    />
    <button
      (click)="buscarPorIdentificacion()"
      class="bg-green-700 text-white px-4 py-2 rounded-md hover:bg-green-800 transition "
    >
      Buscar
    </button>
    <button
      *ngIf="busquedaActiva"
      (click)="limpiarBusqueda()"
      class="bg-gray-400 text-white px-4 py-2 rounded-md hover:bg-gray-500 transition"
    >
      Limpiar
    </button>
  </div>
  <div class="flex flex-col md:flex-row min-h-screen">

    <!----------------------------------------------------------  üìÇ Contenido de proyectos -------------------------------------------------------- -->
    <div class="flex-1 max-w-full mx-auto p-4 sm:p-6 bg-white shadow-md rounded-md">
      <h2
        class="text-xl sm:text-2xl md:text-3xl font-bold text-green-800 mb-6 border-b-4 border-yellow-400 pb-2 flex items-center space-x-2">
        <span>üìÅ</span>
        <span>Proyectos Registrados</span>
      </h2>

      <!--------------------------------------------------------- - Vista m√≥vil  -------------------------------------------------------- -->
      <div class="block sm:hidden space-y-6">
        @for (item of proyectosFiltrados; track item.id; let i = $index) {
          <div class="border border-green-300 rounded-lg shadow-sm p-4 bg-green-50 relative">

            <!-- Bot√≥n eliminar arriba a la derecha -->
            <button
              (click)="eliminarProyecto(item.id)"
              class="absolute top-2 right-2 text-red-600 hover:text-red-800 font-bold"
            >
              ‚úñ
            </button>

            <h3 class="text-lg font-bold text-green-800 mb-2">
              {{ i + 1 }}. {{ item.nombreProyecto }}
            </h3>
            <p class="text-sm text-green-700"><strong>Categor√≠a:</strong> {{ item.categoria }}</p>
            <p class="text-sm text-green-700"><strong>Fecha:</strong> {{ item.fecha | date: 'dd/MM/yyyy' }}</p>

            <div class="mt-3">
              <h4 class="font-semibold text-green-900 mb-2">üë• Estudiantes</h4>
              <div class="space-y-2">
                @for (est of item.estudiantes; track est.identificacion) {
                  <div class="border rounded-md p-2 bg-white shadow-sm">
                    <p class="text-sm"><strong>Nombre:</strong> {{ est.nombres }} {{ est.apellidos }}</p>
                    <p class="text-sm"><strong>G√©nero:</strong> {{ est.genero }}</p>
                    <p class="text-sm"><strong>Programa:</strong> {{ est.programa }}</p>
                    <p class="text-sm"><strong>Correo:</strong> {{ est.correo }}</p>
                    <p class="text-sm"><strong>Celular:</strong> {{ est.tel }}</p>
                    <p class="text-sm"><strong>ID:</strong> {{ est.identificacion }}</p>
                    <p class="text-sm"><strong>UPC:</strong> {{ est.EstudianteUPC === true ? 'S√≠' : 'No' }}</p>
                  </div>
                }
              </div>
            </div>
          </div>
        }
      </div>


      <!-- VISTA ESCRITORIO -->
      <div class="hidden sm:block overflow-x-auto">
        <table class="w-full table-auto border border-green-300 text-left text-sm">
          <thead class="bg-green-100 text-green-900">
          <tr>
          <th class="p-3 border border-green-300 w-10">ID</th>
          <th class="p-3 border border-green-300 w-56">Nombre del Proyecto</th>
          <th class="p-3 border border-green-300 w-32">Categor√≠a</th>
          <th class="p-3 border border-green-300 w-32">Fecha</th>
          <th class="p-3 border border-green-300 w-48">Estudiantes</th>
          <th class="p-3 border border-green-300 w-24">G√©nero</th>
          <th class="p-3 border border-green-300 w-48">Programa</th>
          <th class="p-3 border border-green-300 w-64">Correo</th>
          <th class="p-3 border border-green-300 w-32">Celular</th>
          <th class="p-3 border border-green-300 w-32">Identificaci√≥n</th>
          <th class="p-3 border border-green-300 w-24">Estudiante UPC</th>
          <th class="p-3 border border-green-300 w-32">Tipo de Emprendedor</th>
          <th class="p-3 border border-green-300 w-20 text-center">Acciones</th>
        </tr>
      </thead>
      <!-- ELIMINAR PROYECTO REGISTRADO -->
      <tbody>
        @for (item of proyectosFiltrados; track item.id; let i = $index) {
          @for (est of item.estudiantes; track est.identificacion; let j = $index) {
            <tr>
              @if (j === 0) {
                <td class="p-3 border border-green-300 font-semibold" [attr.rowspan]="item.estudiantes.length">{{ i + 1 }}</td>
                <td class="p-3 border border-green-300 font-semibold" [attr.rowspan]="item.estudiantes.length">{{ item.nombreProyecto }}</td>
                <td class="p-3 border border-green-300" [attr.rowspan]="item.estudiantes.length">{{ item.categoria }}</td>
                <td class="p-3 border border-green-300" [attr.rowspan]="item.estudiantes.length">{{ item.fecha | date: 'dd/MM/yyyy' }}</td>
                }
                <td class="p-3 border border-green-300">{{ est.nombres }} {{ est.apellidos }}</td>
                <td class="p-3 border border-green-300">{{ est.genero }}</td>
                <td class="p-3 border border-green-300">{{ est.programa }}</td>
                <td class="p-3 border border-green-300 break-words">{{ est.correo }}</td>
                <td class="p-3 border border-green-300">{{ est.tel }}</td>
                <td class="p-3 border border-green-300">{{ est.identificacion }}</td>
                <td class="p-3 border border-green-300">{{ est.EstudianteUPC === true ? 'S√≠' : 'No' }}</td>
                <td class="p-3 border border-green-300">{{ est.tipoParticipante }}</td>
                @if (j === 0) {
                <td class="p-3 border border-green-300 text-center" [attr.rowspan]="item.estudiantes.length">
                  <button
                    (click)="eliminarProyecto(item.id)"
                    class="text-red-600 hover:text-red-800 font-bold"
                    >
                    ‚úñ
                  </button>
                </td>
              }
              </tr>
            }
        }
      </tbody>

        </table>
      </div>

    </div>
  </div>
</div>

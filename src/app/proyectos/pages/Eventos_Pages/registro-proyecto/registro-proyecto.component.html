<!-- Fondo general estilo Prosperidad Social -->
<div class="min-h-screen pt-24 pb-10 px-4
         bg-[url('/image/Decorador/fondoregistro.jpg')]
         bg-cover bg-center bg-no-repeat relative">

  <!-- Tarjeta principal -->
  <div class="max-w-6xl mx-auto bg-white rounded-xl shadow-lg overflow-hidden border border-gray-300">

    <!-- Header institucional -->
    <div class="bg-[#8b5a2b] px-6 sm:px-10 py-10 text-white">
      <h1 class="text-2xl sm:text-3xl font-semibold mb-4">
        Registro de Proyectos de Emprendimiento
      </h1>

      <p class="text-sm sm:text-base leading-relaxed">
        Este formulario permite registrar proyectos de emprendimiento desarrollados
        por estudiantes y participantes de la Universidad Popular del Cesar.
      </p>

      <p class="text-xs mt-4 italic opacity-90">
        La información suministrada será tratada conforme a la Ley 1581 de 2012 y el
        Decreto 1377 de 2013.
      </p>
    </div>

    <!-- Contenido del formulario -->
    <div class="px-6 sm:px-10 py-10">

      <!-- Título -->
      <h2 class="text-xl font-semibold text-gray-800 mb-8 border-b pb-3">
        Información General del Proyecto
      </h2>

      <!-- FORMULARIO ORIGINAL (NO SE TOCA LA LÓGICA) -->
      <form class="space-y-6" #form="ngForm" (ngSubmit)="registrar(form)" novalidate>

        <!-- Nombre Proyecto -->
        <div>
          <label class="block font-medium mb-1 text-gray-700">
            Nombre del Proyecto <span class="text-red-500">*</span>
          </label>

          <input
            type="text"
            name="nombreProyecto"
            [(ngModel)]="proyecto.nombreProyecto"
            required
            minlength="3"
            pattern="^[A-Za-zÁÉÍÓÚáéíóúÑñ ]+$"
            #nombreCtrl="ngModel"
            placeholder="Ej: Sistema de riego automatizado"
            class="w-full border border-gray-300 px-4 py-3 rounded-md focus:outline-none focus:ring-2 focus:ring-[#8b5a2b]" />

          <div *ngIf="nombreCtrl.invalid && (nombreCtrl.touched || form.submitted)"
               class="text-red-600 text-sm mt-1">
            <div *ngIf="nombreCtrl.errors?.['required']">El nombre es obligatorio.</div>
            <div *ngIf="nombreCtrl.errors?.['minlength']">Debe tener al menos 3 caracteres.</div>
            <div *ngIf="nombreCtrl.errors?.['pattern']">Solo se permiten letras.</div>
          </div>
        </div>

        <!-- Sección Datos Personales -->
        <h3 class="text-lg font-semibold text-gray-800 border-b pb-2 mt-10">
          Datos Personales de los Emprendedores
        </h3>

        @for (estudiante of proyecto.estudiantes; track estudiante; let i = $index) {
<div class="border border-gray-300 rounded-lg p-6 bg-gray-50 mb-8">

  <h4 class="font-semibold text-[#8b5a2b] mb-6">
    Emprendedor {{ i + 1 }}
  </h4>

  <!-- CONTENEDOR EN UNA SOLA COLUMNA -->
  <div class="flex flex-col gap-5">

    <!-- Nombres -->
    <div>
      <label class="block text-sm font-medium text-gray-700 mb-1">
        Nombres <span class="text-red-500">*</span>
      </label>
      <input
        type="text"
        [(ngModel)]="estudiante.nombres"
        name="nombres{{i}}"
        required
        minlength="2"
        pattern="^[A-Za-zÁÉÍÓÚáéíóúÑñ ]+$"
        #nombresCtrl="ngModel"
        class="w-full border border-gray-300 px-4 py-3 rounded-md
               focus:outline-none focus:ring-2 focus:ring-[#8b5a2b]" />
    </div>

    <!-- Apellidos -->
    <div>
      <label class="block text-sm font-medium text-gray-700 mb-1">
        Apellidos <span class="text-red-500">*</span>
      </label>
      <input
        type="text"
        [(ngModel)]="estudiante.apellidos"
        name="apellidos{{i}}"
        required
        minlength="2"
        pattern="^[A-Za-zÁÉÍÓÚáéíóúÑñ ]+$"
        #apellidosCtrl="ngModel"
        class="w-full border border-gray-300 px-4 py-3 rounded-md
               focus:outline-none focus:ring-2 focus:ring-[#8b5a2b]" />
    </div>

    <!-- Identificación -->
    <div>
      <label class="block text-sm font-medium text-gray-700 mb-1">
        Identificación <span class="text-red-500">*</span>
      </label>
      <input
        type="text"
        name="identificacion{{i}}"
        [(ngModel)]="estudiante.identificacion"
        required
        minlength="6"
        pattern="^[0-9]+$"
        #idCtrl="ngModel"
        class="w-full border border-gray-300 px-4 py-3 rounded-md
               focus:outline-none focus:ring-2 focus:ring-[#8b5a2b]" />
    </div>

    <!-- Programa Académico -->
    <div *ngIf="estudiante.tipoParticipante !== 'Microempresario externo'">
      <label class="block text-sm font-medium text-gray-700 mb-1">
        Programa Académico <span class="text-red-500">*</span>
      </label>
      <select
        [(ngModel)]="estudiante.programaAcademico"
        name="programa{{ i }}"
        required
        #programaCtrl="ngModel"
        class="w-full border border-gray-300 px-4 py-3 rounded-md
               focus:outline-none focus:ring-2 focus:ring-[#8b5a2b]">
        <option value="" disabled selected>Seleccione un programa académico</option>
        <option *ngFor="let prog of programasAcademicos" [value]="prog">
          {{ prog }}
        </option>
      </select>
    </div>

    <!-- Celular -->
    <div>
      <label class="block text-sm font-medium text-gray-700 mb-1">
        Celular <span class="text-red-500">*</span>
      </label>
      <input
        type="text"
        [(ngModel)]="estudiante.tel"
        name="tel{{i}}"
        required
        pattern="^[0-9]{10}$"
        #telCtrl="ngModel"
        class="w-full border border-gray-300 px-4 py-3 rounded-md
               focus:outline-none focus:ring-2 focus:ring-[#8b5a2b]" />
    </div>

    <!-- Correo -->
    <div>
      <label class="block text-sm font-medium text-gray-700 mb-1">
        Correo electrónico <span class="text-red-500">*</span>
      </label>
      <input
        type="email"
        name="correo{{i}}"
        [(ngModel)]="estudiante.correo"
        required
        email
        #correoCtrl="ngModel"
        class="w-full border border-gray-300 px-4 py-3 rounded-md
               focus:outline-none focus:ring-2 focus:ring-[#8b5a2b]" />
    </div>

    <!-- Género -->
    <div>
      <label class="block text-sm font-medium text-gray-700 mb-1">
        Género <span class="text-red-500">*</span>
      </label>
      <select
        [(ngModel)]="estudiante.genero"
        name="genero{{i}}"
        required
        class="w-full border border-gray-300 px-4 py-3 rounded-md
               focus:outline-none focus:ring-2 focus:ring-[#8b5a2b]">
        <option value="" disabled selected>Seleccione una opción</option>
        <option *ngFor="let g of generos" [value]="g">{{ g }}</option>
      </select>
    </div>

    <!-- Categoría -->
    <div>
      <label class="block text-sm font-medium text-gray-700 mb-1">
        Categoría <span class="text-red-500">*</span>
      </label>
      <select
        [(ngModel)]="estudiante.tipoParticipante"
        name="tipoParticipante{{i}}"
        required
        class="w-full border border-gray-300 px-4 py-3 rounded-md
               focus:outline-none focus:ring-2 focus:ring-[#8b5a2b]">
        <option value="" disabled selected>Seleccione una categoría</option>
        <option *ngFor="let cat of TipoParticipante" [value]="cat">
          {{ cat }}
        </option>
      </select>
    </div>

    <!-- Estudiante UPC -->
    <div>
      <label class="block text-sm font-medium text-gray-700 mb-2">
        ¿Es estudiante de la Universidad Popular del Cesar? <span class="text-red-500">*</span>
      </label>
      <div class="flex gap-10">
        <label class="inline-flex items-center gap-2">
          <input
            type="radio"
            name="estudianteUPC{{i}}"
            [(ngModel)]="estudiante.EstudianteUPC"
            [value]="true"
            class="text-[#8b5a2b] focus:ring-[#8b5a2b]" />
          <span>Sí</span>
        </label>

        <label class="inline-flex items-center gap-2">
          <input
            type="radio"
            name="estudianteUPC{{i}}"
            [(ngModel)]="estudiante.EstudianteUPC"
            [value]="false"
            class="text-[#8b5a2b] focus:ring-[#8b5a2b]" />
          <span>No</span>
        </label>
      </div>
    </div>

  </div>

  <!-- Eliminar estudiante -->
  <div class="mt-6 text-right">
    <button
      type="button"
      (click)="eliminarEstudiante(i)"
      class="text-red-600 text-sm hover:underline">
      Eliminar emprendedor
    </button>
  </div>

</div>
}


        <!-- Agregar -->
        <button type="button" (click)="agregarEstudiante()"
          class="text-[#8b5a2b] font-medium hover:underline">
          + Agregar otro emprendedor
        </button>

        <!-- Botón final -->
        <div class="pt-6 border-t">
          <button
            type="submit"
            [disabled]="form.invalid"
            class="bg-[#8b5a2b] text-white px-8 py-3 rounded-md hover:bg-[#73471f] transition disabled:opacity-50">
            Registrar Proyecto
          </button>
        </div>

      </form>

      <div *ngIf="registroExitoso"
           class="mt-4 p-3 bg-green-100 border border-green-300 text-green-800 rounded">
        ✅ Registro exitoso.
      </div>

    </div>
  </div>
</div>
